{"ast":null,"code":"var _jsxFileName = \"/Users/adhnanasharaf/Projects/React/ecommerse/client/src/App.js\";\nimport React, { useState, Component } from \"react\";\nimport { Switch, Route, Link, BrowserRouter as Router, Redirect } from \"react-router-dom\";\nimport Cart from \"./components/CartPage\";\nimport Login from \"./components/Login\";\nimport ProductList from \"./components/ProductList\";\nimport AddProducts from \"./components/AddProducts\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport { render } from \"@testing-library/react\";\nimport { Navbar, Nav, NavDropdown, Form, FormControl, Button } from \"react-bootstrap\";\nimport Context from \"./Context\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.login = async (email, password) => {\n      const res = await axios.post(\"/login\", {\n        email,\n        password\n      }).catch(res => {\n        return {\n          status: 404,\n          message: \"unauthorised user\"\n        };\n      });\n\n      if (res.data === true) {\n        console.log(\"authentication process cleared\");\n        const user = {\n          email,\n          accessToken: email === \"admin@example.com\" ? 0 : 1\n        };\n\n        if (email === \"admin@example.com\") {\n          let admin = this.state.admin;\n          admin = true;\n          this.setState({\n            admin,\n            isLoading: false\n          });\n          localStorage.setItem(\"admin\", {\n            admin\n          });\n        }\n\n        const arrUser = Object.keys(user).map(index => {\n          let person = user[index];\n          return person;\n        });\n        this.setState({\n          arrUser,\n          isLoading: false\n        }, () => {});\n        localStorage.setItem(\"user\", JSON.stringify(user));\n\n        /*#__PURE__*/\n        _jsxDEV(Redirect, {\n          to: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 7\n        }, this);\n\n        console.log(\"login fully successed\");\n        return true;\n      } else {\n        return false;\n      }\n    };\n\n    this.addToCart = cartItem => {\n      console.log(\"cart item form top of the add tocart cartItem\", cartItem);\n      let cart = this.state.cart;\n      console.log(\"from top of the addtocart\", cart);\n      console.log(cart);\n      console.log(cartItem.id); // console.log(cart.includes(cartItem.id))\n\n      const found = cart.some(el => el.id === cartItem.id);\n      const elementsIndex = cart.findIndex(element => element.id == cartItem.id);\n      console.log(elementsIndex);\n      console.log(found);\n\n      if (elementsIndex >= 0) {\n        console.log(\"count added\");\n        cart[elementsIndex].amount += cartItem.amount;\n      } else {\n        console.log(\"new added\");\n        cart.push(cartItem);\n      }\n\n      console.log(\"before updating to the state\", cart);\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState(cart);\n      console.log(\"this is bottom of add to cart  \", this.state.cart);\n    };\n\n    this.removeFromCart = cartItem => {\n      let cart = this.state.cart;\n      const elementsIndex = cart.findIndex(element => element.id == cartItem.id);\n      console.log(elementsIndex);\n      cart.splice(elementsIndex, 1);\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState(cart);\n    };\n\n    this.changingQuantity = details => {\n      console.log(\"change in quantity called\", details.direction);\n      let cart = this.state.cart;\n      const elementsIndex = cart.findIndex(element => element.id == details.id);\n      console.log(elementsIndex);\n\n      if (details.direction === \"increase\") {\n        cart[elementsIndex].amount += 1;\n      } else {\n        cart[elementsIndex].amount -= 1;\n\n        if (cart[elementsIndex].amount === 0) {\n          cart.splice(elementsIndex, 1);\n        }\n      }\n\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState(cart);\n    };\n\n    this.AddProducts = (id, product) => {\n      console.log(id, product);\n      const sentToBackend = axios.post(\"/addproducts\", {\n        id,\n        product\n      }).then(res => {\n        console.log(res.data);\n      });\n    };\n\n    this.ShowAllProducts = () => {\n      console.log(\"show all products called\");\n    };\n\n    this.logout = () => {\n      console.log(this.state.user);\n      console.log(\"logout called\"); // e.preventDefault();\n\n      let admin = this.state.admin;\n      admin = false;\n      this.setState({\n        admin\n      });\n      localStorage.setItem(\"admin\", admin);\n      this.setState({\n        user: \"\"\n      });\n      localStorage.removeItem(\"user\");\n    };\n\n    this.state = {\n      user: null,\n      cart: [],\n      products: [],\n      showMenu: null,\n      admin: false\n    };\n    this.routerRef = /*#__PURE__*/React.createRef();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Context.Provider, {\n      value: { ...this.state,\n        login: this.login,\n        addToCart: this.addToCart,\n        cart: this.state.cart,\n        removeFromCart: this.removeFromCart,\n        changingQuantity: this.changingQuantity,\n        AddProducts: this.AddProducts,\n        ShowAllProducts: this.ShowAllProducts\n      },\n      children: /*#__PURE__*/_jsxDEV(Router, {\n        ref: this.routerRef,\n        children: [/*#__PURE__*/_jsxDEV(Navbar, {\n          bg: \"light\",\n          expand: \"lg\",\n          children: [/*#__PURE__*/_jsxDEV(Navbar.Brand, {\n            href: \"\",\n            children: \"Ecommerse\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Navbar.Toggle, {\n            \"aria-controls\": \"basic-navbar-nav\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Navbar.Collapse, {\n            id: \"basic-navbar-nav\",\n            children: [/*#__PURE__*/_jsxDEV(Nav, {\n              className: \"mr-auto\",\n              children: [/*#__PURE__*/_jsxDEV(Nav.Link, {\n                href: this.state.user ? \"/cart\" : \"/login\",\n                children: \"Cart\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 68,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Nav.Link, {\n                href: \"/\",\n                children: \"Products\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 71,\n                columnNumber: 17\n              }, this), this.state.admin === true ? /*#__PURE__*/_jsxDEV(Nav.Link, {\n                href: \"/Add-products\",\n                children: \"Add Products\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 47\n              }, this) : \"\", /*#__PURE__*/_jsxDEV(NavDropdown, {\n                title: !this.state.user ? \"account\" : this.state.user[0],\n                id: \"basic-nav-dropdown\",\n                children: !this.state.user ? /*#__PURE__*/_jsxDEV(NavDropdown.Item, {\n                  href: \"/login\",\n                  children: \"Login\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 82,\n                  columnNumber: 19\n                }, this) : /*#__PURE__*/_jsxDEV(NavDropdown.Item, {\n                  onClick: this.logout,\n                  children: \"Logout\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 84,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Form, {\n              inline: true,\n              children: [/*#__PURE__*/_jsxDEV(FormControl, {\n                type: \"text\",\n                placeholder: \"Search\",\n                className: \"mr-sm-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 91,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline-success\",\n                children: \"Search\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 96,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Switch, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/cart\",\n            children: /*#__PURE__*/_jsxDEV(Cart, {\n              removeFromCart: this.removeFromCart\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/\",\n            children: /*#__PURE__*/_jsxDEV(ProductList, {\n              products: this.state.products,\n              isLoading: this.state.isLoading,\n              addToCart: this.addToCart\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/Login\",\n            children: /*#__PURE__*/_jsxDEV(Login, {\n              login: this.login\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/Add-products\",\n            children: /*#__PURE__*/_jsxDEV(AddProducts, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this);\n  }\n\n  async componentDidMount() {\n    const api = await axios.get(\"/api\");\n    console.log(api);\n    let user = localStorage.getItem(\"user\");\n    let cart = localStorage.getItem(\"cart\");\n    let admin = localStorage.getItem(\"admin\");\n    console.log(admin);\n    console.log(user);\n    const products = await axios.get(\"/products\").then(responce => {\n      this.setState({\n        isLoading: false\n      });\n    });\n    console.log(products.data.products);\n    user = user ? JSON.parse(user) : null;\n    cart = cart ? JSON.parse(cart) : [];\n    let arrUser = null;\n    user ? arrUser = Object.keys(user).map(index => {\n      let person = user[index];\n      return person;\n    }) : arrUser = null;\n    this.setState({\n      isLoading: true,\n      user: arrUser,\n      products: products.data.products,\n      cart,\n      admin,\n      isLoading: false\n    });\n    console.log(\"app\", this.state.cart); // console.log(this.state.user);\n\n    console.log(this.state.admin); //localStorage.removeItem(\"cart\");\n  }\n\n}","map":{"version":3,"sources":["/Users/adhnanasharaf/Projects/React/ecommerse/client/src/App.js"],"names":["React","useState","Component","Switch","Route","Link","BrowserRouter","Router","Redirect","Cart","Login","ProductList","AddProducts","axios","jwt_decode","render","Navbar","Nav","NavDropdown","Form","FormControl","Button","Context","App","constructor","props","login","email","password","res","post","catch","status","message","data","console","log","user","accessToken","admin","state","setState","isLoading","localStorage","setItem","arrUser","Object","keys","map","index","person","JSON","stringify","addToCart","cartItem","cart","id","found","some","el","elementsIndex","findIndex","element","amount","push","removeFromCart","splice","changingQuantity","details","direction","product","sentToBackend","then","ShowAllProducts","logout","removeItem","products","showMenu","routerRef","createRef","componentDidMount","api","get","getItem","responce","parse"],"mappings":"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","sourcesContent":["import React, { useState, Component } from \"react\";\nimport {\n  Switch,\n  Route,\n  Link,\n  BrowserRouter as Router,\n  Redirect,\n} from \"react-router-dom\";\n\nimport Cart from \"./components/CartPage\";\nimport Login from \"./components/Login\";\nimport ProductList from \"./components/ProductList\";\nimport AddProducts from \"./components/AddProducts\";\n\n\nimport axios from \"axios\";\n\nimport jwt_decode from \"jwt-decode\";\nimport { render } from \"@testing-library/react\";\nimport {\n  Navbar,\n  Nav,\n  NavDropdown,\n  Form,\n  FormControl,\n  Button,\n} from \"react-bootstrap\";\n\n\n\n\nimport Context from \"./Context\";\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      user: null,\n      cart: [],\n      products: [],\n      showMenu: null,\n  admin:  false\n\n    };\n    this.routerRef = React.createRef();\n  }\n\n  render() {\n    return (\n      <Context.Provider\n        value={{\n          ...this.state,\n          login: this.login,\n          addToCart: this.addToCart,\n          cart: this.state.cart,\n          removeFromCart:this.removeFromCart,\n          changingQuantity:this.changingQuantity,\n          AddProducts:this.AddProducts,\n          ShowAllProducts:this.  ShowAllProducts\n        }}\n      >\n        <Router ref={this.routerRef}>\n          <Navbar bg=\"light\" expand=\"lg\">\n            <Navbar.Brand href=\"\">Ecommerse</Navbar.Brand>\n            <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n            <Navbar.Collapse id=\"basic-navbar-nav\">\n              <Nav className=\"mr-auto\">\n                <Nav.Link href={this.state.user ? \"/cart\" : \"/login\"}>\n                  Cart\n                </Nav.Link>\n                <Nav.Link href=\"/\">Products</Nav.Link>\n                {this.state.admin === true ?( <Nav.Link href=\"/Add-products\">Add Products</Nav.Link>)\n                 :\"\"\n                }\n                \n\n                <NavDropdown\n                  title={!this.state.user ? \"account\" : this.state.user[0]}\n                  id=\"basic-nav-dropdown\"\n                >\n                  {!this.state.user ? (\n                  <NavDropdown.Item href=\"/login\">Login</NavDropdown.Item>\n                  ) : (\n                  <NavDropdown.Item onClick={this.logout}>\n                    Logout\n                  </NavDropdown.Item>\n                  )}\n                </NavDropdown>\n              </Nav>\n              <Form inline>\n                <FormControl\n                  type=\"text\"\n                  placeholder=\"Search\"\n                  className=\"mr-sm-2\"\n                />\n                <Button variant=\"outline-success\">Search</Button>\n              </Form>\n            </Navbar.Collapse>\n          </Navbar>\n\n          <Switch>\n            <Route exact path=\"/cart\">\n              <Cart \n               removeFromCart = {this.removeFromCart}\n              />\n            </Route>\n            <Route exact path=\"/\">\n              \n              <ProductList\n                products={this.state.products}\n                isLoading = {this.state.isLoading}\n                addToCart={this.addToCart}\n               \n              />\n            </Route>\n            <Route exact path=\"/Login\">\n              <Login login={this.login} />\n            </Route>\n\n          \n\n            <Route exact path=\"/Add-products\">\n              <AddProducts />\n            </Route>\n          </Switch>\n        </Router>\n      </Context.Provider>\n    );\n  }\n\n  async componentDidMount() {\n    const api = await axios.get(\"/api\");\n    console.log(api)\n    let user = localStorage.getItem(\"user\");\n    let cart = localStorage.getItem(\"cart\");\n    let admin = localStorage.getItem(\"admin\");\n    console.log(admin)\n console.log(user)\n\n   const products = await axios.get(\"/products\").then(responce =>{\n     this.setState({isLoading:false});\n   });\n   console.log(products.data.products)\n\n    user = user ? JSON.parse(user) : null;\n    cart = cart ? JSON.parse(cart) : [];\n    let arrUser = null;\n    user\n      ? (arrUser = Object.keys(user).map((index) => {\n          let person = user[index];\n          return person;\n        }))\n      : (arrUser = null);\n    this.setState({isLoading:true, user: arrUser, products: products.data.products, cart ,admin, isLoading:false});\n    console.log(\"app\", this.state.cart);\n    // console.log(this.state.user);\n    console.log(this.state.admin);\n    //localStorage.removeItem(\"cart\");\n  } \n  login = async (email, password) => {\n    const res = await axios\n      .post(\"/login\", { email, password })\n      .catch((res) => {\n        \n        return { status: 404, message: \"unauthorised user\" };\n      });\n\n    if (res.data === true) {\n      console.log(\"authentication process cleared\");\n\n\n      const user = {\n        email,\n        accessToken: email === \"admin@example.com\" ? 0 : 1,\n        \n      };\n      if(email === \"admin@example.com\"){\n        let admin = this.state.admin;\n        admin = true;\n        this.setState({admin,isLoading:false})\n        localStorage.setItem(\"admin\", ({admin}));\n      }\n\n      const arrUser = Object.keys(user).map((index) => {\n        let person = user[index];\n        return person;\n      });\n      this.setState({ arrUser,isLoading:false }, () => {});\n\n      localStorage.setItem(\"user\", JSON.stringify(user));\n      <Redirect to=\"/\" />;\n      console.log(\"login fully successed\");\n\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  addToCart = (cartItem) => {\n    console.log(\"cart item form top of the add tocart cartItem\", cartItem);\n    let cart = this.state.cart;\n    console.log(\"from top of the addtocart\", cart);\n\n    console.log(cart);\n    console.log(cartItem.id);\n    // console.log(cart.includes(cartItem.id))\n\n    const found = cart.some((el) => el.id === cartItem.id);\n    const elementsIndex = cart.findIndex(\n      (element) => element.id == cartItem.id\n    );\n    console.log(elementsIndex);\n    console.log(found);\n    if (elementsIndex >= 0) {\n      console.log(\"count added\");\n      cart[elementsIndex].amount += cartItem.amount;\n    } else {\n      console.log(\"new added\");\n      cart.push(cartItem);\n    }\n    console.log(\"before updating to the state\", cart);\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\n    this.setState(cart);\n    console.log(\"this is bottom of add to cart  \", this.state.cart);\n  };\n  removeFromCart=(cartItem)=>{\n\n    let cart = this.state.cart;\n    const elementsIndex = cart.findIndex(\n      (element) => element.id == cartItem.id\n    );\n    console.log(elementsIndex)\n    cart.splice(elementsIndex, 1);\n\n\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState(cart);\n  }\n\nchangingQuantity=(details)=>{\n  console.log(\"change in quantity called\",details.direction)\n\n\n  let cart = this.state.cart;\n  const elementsIndex = cart.findIndex(\n    (element) => element.id == details.id\n  );\n  console.log(elementsIndex)\nif(details.direction === \"increase\"){\n    cart[elementsIndex].amount += 1;\n}else{\n  cart[elementsIndex].amount -= 1;\n  if(cart[elementsIndex].amount === 0){\n    cart.splice(elementsIndex, 1);\n  }\n}\n\nlocalStorage.setItem(\"cart\", JSON.stringify(cart));\nthis.setState(cart);\n}\n\nAddProducts = (id,product) => {\n  console.log(id,product)\n  const sentToBackend =  axios\n      .post(\"/addproducts\", {id,product }).then((res)=>{\n  console.log(res.data)\n      })\n\n  };\n\n  ShowAllProducts=()=>{\n    console.log(\"show all products called\")\n  }\n\n  logout = () => {\n    console.log(this.state.user);\n    console.log(\"logout called\");\n    // e.preventDefault();\n    let admin = this.state.admin;\n    admin = false;\n    this.setState({admin})\n    localStorage.setItem(\"admin\", (admin));\n\n    this.setState({ user: \"\" });\n    localStorage.removeItem(\"user\");\n  };\n}\n"]},"metadata":{},"sourceType":"module"}