{"ast":null,"code":"import _objectSpread from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/adhnanasharaf/Projects/React/ecommerse/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{useState,Component}from\"react\";import{Switch,Route,Link,BrowserRouter as Router,Redirect}from\"react-router-dom\";import Cart from\"./components/CartPage\";import Login from\"./components/Login\";import ProductList from\"./components/ProductList\";import AddProducts from\"./components/AddProducts\";import axios from\"axios\";import jwt_decode from\"jwt-decode\";import{render}from\"@testing-library/react\";import{Navbar,Nav,NavDropdown,Form,FormControl,Button}from\"react-bootstrap\";import Context from\"./Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email,password){var res,user,admin,arrUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post(\"/login\",{email:email,password:password}).catch(function(res){return{status:404,message:\"unauthorised user\"};});case 2:res=_context.sent;if(!(res.data===true)){_context.next=15;break;}console.log(\"authentication process cleared\");user={email:email,accessToken:email===\"admin@example.com\"?0:1};if(email===\"admin@example.com\"){admin=_this.state.admin;admin=true;_this.setState({admin:admin});localStorage.setItem(\"admin\",{admin:admin});}arrUser=Object.keys(user).map(function(index){var person=user[index];return person;});_this.setState({arrUser:arrUser},function(){});localStorage.setItem(\"user\",JSON.stringify(user));/*#__PURE__*/_jsx(Redirect,{to:\"/\"});console.log(\"login fully successed\");return _context.abrupt(\"return\",true);case 15:return _context.abrupt(\"return\",false);case 16:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();_this.addToCart=function(cartItem){console.log(\"cart item form top of the add tocart cartItem\",cartItem);var cart=_this.state.cart;console.log(\"from top of the addtocart\",cart);console.log(cart);console.log(cartItem.id);// console.log(cart.includes(cartItem.id))\nvar found=cart.some(function(el){return el.id===cartItem.id;});var elementsIndex=cart.findIndex(function(element){return element.id==cartItem.id;});console.log(elementsIndex);console.log(found);if(elementsIndex>=0){console.log(\"count added\");cart[elementsIndex].amount+=cartItem.amount;}else{console.log(\"new added\");cart.push(cartItem);}console.log(\"before updating to the state\",cart);localStorage.setItem(\"cart\",JSON.stringify(cart));_this.setState(cart);console.log(\"this is bottom of add to cart  \",_this.state.cart);};_this.removeFromCart=function(cartItem){var cart=_this.state.cart;var elementsIndex=cart.findIndex(function(element){return element.id==cartItem.id;});console.log(elementsIndex);cart.splice(elementsIndex,1);localStorage.setItem(\"cart\",JSON.stringify(cart));_this.setState(cart);};_this.changingQuantity=function(details){console.log(\"change in quantity called\",details.direction);var cart=_this.state.cart;var elementsIndex=cart.findIndex(function(element){return element.id==details.id;});console.log(elementsIndex);if(details.direction===\"increase\"){cart[elementsIndex].amount+=1;}else{cart[elementsIndex].amount-=1;if(cart[elementsIndex].amount===0){cart.splice(elementsIndex,1);}}localStorage.setItem(\"cart\",JSON.stringify(cart));_this.setState(cart);};_this.AddProducts=function(id,product){console.log(id,product);var sentToBackend=axios.post(\"/addproducts\",{id:id,product:product}).then(function(res){console.log(res.data);});};_this.ShowAllProducts=function(){console.log(\"show all products called\");};_this.logout=function(){console.log(_this.state.user);console.log(\"logout called\");// e.preventDefault();\nvar admin=_this.state.admin;admin=false;_this.setState({admin:admin});localStorage.setItem(\"admin\",admin);_this.setState({user:\"\"});localStorage.removeItem(\"user\");};_this.state={user:null,cart:[],products:[],showMenu:null,admin:false};_this.routerRef=/*#__PURE__*/React.createRef();return _this;}_createClass(App,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(Context.Provider,{value:_objectSpread(_objectSpread({},this.state),{},{login:this.login,addToCart:this.addToCart,cart:this.state.cart,removeFromCart:this.removeFromCart,changingQuantity:this.changingQuantity,AddProducts:this.AddProducts,ShowAllProducts:this.ShowAllProducts}),children:/*#__PURE__*/_jsxs(Router,{ref:this.routerRef,children:[/*#__PURE__*/_jsxs(Navbar,{bg:\"light\",expand:\"lg\",children:[/*#__PURE__*/_jsx(Navbar.Brand,{href:\"\",children:\"Ecommerse\"}),/*#__PURE__*/_jsx(Navbar.Toggle,{\"aria-controls\":\"basic-navbar-nav\"}),/*#__PURE__*/_jsxs(Navbar.Collapse,{id:\"basic-navbar-nav\",children:[/*#__PURE__*/_jsxs(Nav,{className:\"mr-auto\",children:[/*#__PURE__*/_jsx(Nav.Link,{href:this.state.user?\"/cart\":\"/login\",children:\"Cart\"}),/*#__PURE__*/_jsx(Nav.Link,{href:\"/\",children:\"Products\"}),this.state.admin===true?/*#__PURE__*/_jsx(Nav.Link,{href:\"/Add-products\",children:\"Add Products\"}):\"\",/*#__PURE__*/_jsx(NavDropdown,{title:!this.state.user?\"account\":this.state.user[0],id:\"basic-nav-dropdown\",children:!this.state.user?/*#__PURE__*/_jsx(NavDropdown.Item,{href:\"/login\",children:\"Login\"}):/*#__PURE__*/_jsx(NavDropdown.Item,{onClick:this.logout,children:\"Logout\"})})]}),/*#__PURE__*/_jsxs(Form,{inline:true,children:[/*#__PURE__*/_jsx(FormControl,{type:\"text\",placeholder:\"Search\",className:\"mr-sm-2\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",children:\"Search\"})]})]})]}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/cart\",children:/*#__PURE__*/_jsx(Cart,{removeFromCart:this.removeFromCart})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",children:/*#__PURE__*/_jsx(ProductList,{products:this.state.products,addToCart:this.addToCart})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/Login\",children:/*#__PURE__*/_jsx(Login,{login:this.login})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/Add-products\",children:/*#__PURE__*/_jsx(AddProducts,{})})]})]})});}},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var api,user,cart,admin,products,arrUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"/api\");case 2:api=_context2.sent;console.log(api);user=localStorage.getItem(\"user\");cart=localStorage.getItem(\"cart\");admin=localStorage.getItem(\"admin\");console.log(admin);console.log(user);_context2.next=11;return axios.get(\"/products\");case 11:products=_context2.sent;console.log(products.data.products);user=user?JSON.parse(user):null;cart=cart?JSON.parse(cart):[];arrUser=null;user?arrUser=Object.keys(user).map(function(index){var person=user[index];return person;}):arrUser=null;this.setState({user:arrUser,products:products.data.products,cart:cart,admin:admin});console.log(\"app\",this.state.cart);// console.log(this.state.user);\nconsole.log(this.state.admin);//localStorage.removeItem(\"cart\");\ncase 20:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()}]);return App;}(Component);export{App as default};","map":{"version":3,"sources":["/Users/adhnanasharaf/Projects/React/ecommerse/client/src/App.js"],"names":["React","useState","Component","Switch","Route","Link","BrowserRouter","Router","Redirect","Cart","Login","ProductList","AddProducts","axios","jwt_decode","render","Navbar","Nav","NavDropdown","Form","FormControl","Button","Context","App","props","login","email","password","post","catch","res","status","message","data","console","log","user","accessToken","admin","state","setState","localStorage","setItem","arrUser","Object","keys","map","index","person","JSON","stringify","addToCart","cartItem","cart","id","found","some","el","elementsIndex","findIndex","element","amount","push","removeFromCart","splice","changingQuantity","details","direction","product","sentToBackend","then","ShowAllProducts","logout","removeItem","products","showMenu","routerRef","createRef","get","api","getItem","parse"],"mappings":"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","sourcesContent":["import React, { useState, Component } from \"react\";\nimport {\n  Switch,\n  Route,\n  Link,\n  BrowserRouter as Router,\n  Redirect,\n} from \"react-router-dom\";\n\nimport Cart from \"./components/CartPage\";\nimport Login from \"./components/Login\";\nimport ProductList from \"./components/ProductList\";\nimport AddProducts from \"./components/AddProducts\";\n\n\nimport axios from \"axios\";\n\nimport jwt_decode from \"jwt-decode\";\nimport { render } from \"@testing-library/react\";\nimport {\n  Navbar,\n  Nav,\n  NavDropdown,\n  Form,\n  FormControl,\n  Button,\n} from \"react-bootstrap\";\n\n\n\n\nimport Context from \"./Context\";\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      user: null,\n      cart: [],\n      products: [],\n      showMenu: null,\n  admin:  false\n\n    };\n    this.routerRef = React.createRef();\n  }\n\n  render() {\n    return (\n      <Context.Provider\n        value={{\n          ...this.state,\n          login: this.login,\n          addToCart: this.addToCart,\n          cart: this.state.cart,\n          removeFromCart:this.removeFromCart,\n          changingQuantity:this.changingQuantity,\n          AddProducts:this.AddProducts,\n          ShowAllProducts:this.  ShowAllProducts\n        }}\n      >\n        <Router ref={this.routerRef}>\n          <Navbar bg=\"light\" expand=\"lg\">\n            <Navbar.Brand href=\"\">Ecommerse</Navbar.Brand>\n            <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n            <Navbar.Collapse id=\"basic-navbar-nav\">\n              <Nav className=\"mr-auto\">\n                <Nav.Link href={this.state.user ? \"/cart\" : \"/login\"}>\n                  Cart\n                </Nav.Link>\n                <Nav.Link href=\"/\">Products</Nav.Link>\n                {this.state.admin === true ?( <Nav.Link href=\"/Add-products\">Add Products</Nav.Link>)\n                 :\"\"\n                }\n                \n\n                <NavDropdown\n                  title={!this.state.user ? \"account\" : this.state.user[0]}\n                  id=\"basic-nav-dropdown\"\n                >\n                  {!this.state.user ? (\n                  <NavDropdown.Item href=\"/login\">Login</NavDropdown.Item>\n                  ) : (\n                  <NavDropdown.Item onClick={this.logout}>\n                    Logout\n                  </NavDropdown.Item>\n                  )}\n                </NavDropdown>\n              </Nav>\n              <Form inline>\n                <FormControl\n                  type=\"text\"\n                  placeholder=\"Search\"\n                  className=\"mr-sm-2\"\n                />\n                <Button variant=\"outline-success\">Search</Button>\n              </Form>\n            </Navbar.Collapse>\n          </Navbar>\n\n          <Switch>\n            <Route exact path=\"/cart\">\n              <Cart \n               removeFromCart = {this.removeFromCart}\n              />\n            </Route>\n            <Route exact path=\"/\">\n              \n              <ProductList\n                products={this.state.products}\n                addToCart={this.addToCart}\n               \n              />\n            </Route>\n            <Route exact path=\"/Login\">\n              <Login login={this.login} />\n            </Route>\n\n          \n\n            <Route exact path=\"/Add-products\">\n              <AddProducts />\n            </Route>\n          </Switch>\n        </Router>\n      </Context.Provider>\n    );\n  }\n\n  async componentDidMount() {\n    const api = await axios.get(\"/api\");\n    console.log(api)\n    let user = localStorage.getItem(\"user\");\n    let cart = localStorage.getItem(\"cart\");\n    let admin = localStorage.getItem(\"admin\");\n    console.log(admin)\n console.log(user)\n\n   const products = await axios.get(\"/products\");\n   console.log(products.data.products)\n\n    user = user ? JSON.parse(user) : null;\n    cart = cart ? JSON.parse(cart) : [];\n    let arrUser = null;\n    user\n      ? (arrUser = Object.keys(user).map((index) => {\n          let person = user[index];\n          return person;\n        }))\n      : (arrUser = null);\n    this.setState({ user: arrUser, products: products.data.products, cart ,admin});\n    console.log(\"app\", this.state.cart);\n    // console.log(this.state.user);\n    console.log(this.state.admin);\n    //localStorage.removeItem(\"cart\");\n  } \n  login = async (email, password) => {\n    const res = await axios\n      .post(\"/login\", { email, password })\n      .catch((res) => {\n        \n        return { status: 404, message: \"unauthorised user\" };\n      });\n\n    if (res.data === true) {\n      console.log(\"authentication process cleared\");\n\n\n      const user = {\n        email,\n        accessToken: email === \"admin@example.com\" ? 0 : 1,\n        \n      };\n      if(email === \"admin@example.com\"){\n        let admin = this.state.admin;\n        admin = true;\n        this.setState({admin})\n        localStorage.setItem(\"admin\", ({admin}));\n      }\n\n      const arrUser = Object.keys(user).map((index) => {\n        let person = user[index];\n        return person;\n      });\n      this.setState({ arrUser }, () => {});\n\n      localStorage.setItem(\"user\", JSON.stringify(user));\n      <Redirect to=\"/\" />;\n      console.log(\"login fully successed\");\n\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  addToCart = (cartItem) => {\n    console.log(\"cart item form top of the add tocart cartItem\", cartItem);\n    let cart = this.state.cart;\n    console.log(\"from top of the addtocart\", cart);\n\n    console.log(cart);\n    console.log(cartItem.id);\n    // console.log(cart.includes(cartItem.id))\n\n    const found = cart.some((el) => el.id === cartItem.id);\n    const elementsIndex = cart.findIndex(\n      (element) => element.id == cartItem.id\n    );\n    console.log(elementsIndex);\n    console.log(found);\n    if (elementsIndex >= 0) {\n      console.log(\"count added\");\n      cart[elementsIndex].amount += cartItem.amount;\n    } else {\n      console.log(\"new added\");\n      cart.push(cartItem);\n    }\n    console.log(\"before updating to the state\", cart);\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\n    this.setState(cart);\n    console.log(\"this is bottom of add to cart  \", this.state.cart);\n  };\n  removeFromCart=(cartItem)=>{\n\n    let cart = this.state.cart;\n    const elementsIndex = cart.findIndex(\n      (element) => element.id == cartItem.id\n    );\n    console.log(elementsIndex)\n    cart.splice(elementsIndex, 1);\n\n\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState(cart);\n  }\n\nchangingQuantity=(details)=>{\n  console.log(\"change in quantity called\",details.direction)\n\n\n  let cart = this.state.cart;\n  const elementsIndex = cart.findIndex(\n    (element) => element.id == details.id\n  );\n  console.log(elementsIndex)\nif(details.direction === \"increase\"){\n    cart[elementsIndex].amount += 1;\n}else{\n  cart[elementsIndex].amount -= 1;\n  if(cart[elementsIndex].amount === 0){\n    cart.splice(elementsIndex, 1);\n  }\n}\n\nlocalStorage.setItem(\"cart\", JSON.stringify(cart));\nthis.setState(cart);\n}\n\nAddProducts = (id,product) => {\n  console.log(id,product)\n  const sentToBackend =  axios\n      .post(\"/addproducts\", {id,product }).then((res)=>{\n  console.log(res.data)\n      })\n\n  };\n\n  ShowAllProducts=()=>{\n    console.log(\"show all products called\")\n  }\n\n  logout = () => {\n    console.log(this.state.user);\n    console.log(\"logout called\");\n    // e.preventDefault();\n    let admin = this.state.admin;\n    admin = false;\n    this.setState({admin})\n    localStorage.setItem(\"admin\", (admin));\n\n    this.setState({ user: \"\" });\n    localStorage.removeItem(\"user\");\n  };\n}\n"]},"metadata":{},"sourceType":"module"}